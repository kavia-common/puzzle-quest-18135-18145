{"is_source_file": true, "format": "Kotlin", "description": "This file implements a LocaleManager object for managing language preferences within an Android application. It handles persisting the selected language using DataStore, observing language changes via Flow, and applying locale updates to Activity instances.", "external_files": ["androidx.datastore.preferences.core.edit", "androidx.datastore.preferences.core.stringPreferencesKey", "androidx.datastore.preferences.preferencesDataStore", "android.os.Build", "java.util.Locale"], "external_methods": ["preferencesDataStore", "data", "edit", "stringPreferencesKey", "Locale.getDefault", "Locale.lowercase", "Locale(\"es\")", "activity.resources", "activity.applyOverrideConfiguration", "resources.updateConfiguration"], "published": ["LocaleManager"], "classes": [{"name": "LocaleManager", "description": "Singleton object managing locale preferences, persistence, and application within Android activities."}], "methods": [{"name": "observeLanguage", "description": "Returns a Flow stream of the current language code, either persisted or default system language."}, {"name": "setLanguage", "description": "Persists a selected language code into DataStore."}, {"name": "applyLocale", "description": "Applies the specified language locale to an activity's configuration."}, {"name": "getDefaultLanguage", "description": "Returns the default language, limited to supported ones ('en' or 'es'), based on device settings."}, {"name": "normalize", "description": "Converts various language codes into either 'en' or 'es' for supported locales."}, {"name": "getSupportedLocale", "description": "Maps normalized language code to a Locale instance."}, {"name": "updateActivityLocale", "description": "Updates the locale configuration of the specified activity based on the given Locale object."}], "calls": ["context.dataStore.data", "prefs[KEY_LANGUAGE]", "context.dataStore.edit", "settings[KEY_LANGUAGE]", "getDefaultLanguage", "Locale.getDefault", "normalize", "getSupportedLocale", "activity.resources", "resources.updateConfiguration", "activity.applyOverrideConfiguration"], "search-terms": ["LocaleManager", "Android language persistence", "DataStore language setting", "Locale application in Android", "kotlin android locale management"], "state": 2, "file_id": 16, "knowledge_revision": 88, "git_revision": "", "hash": "95a6e91907459e3d2004569c458ae05d", "format-version": 4, "code-base-name": "mobile_game_frontend", "filename": "mobile_game_frontend/app/src/main/kotlin/org/example/app/i18n/LocaleManager.kt", "revision_history": [{"88": ""}]}